<ion-header>
  <ion-toolbar>
    <ion-title>{{ ejercicio.nombre }}</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="cerrar()">Cerrar</ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content class="modal-content ion-padding">
  <!-- 🔹 Imagen -->
  <div class="gif">
    <img [src]="ejercicio.imagen_gif" alt="{{ ejercicio.nombre }}" />
  </div>

  <!-- 🔹 Descripción -->
  <h2>Descripción</h2>
  <p>{{ ejercicio.descripcion || 'Sin descripción disponible.' }}</p>

  <!-- 🔹 Sección de entrenamiento -->
  <h2>Agregar a entrenamiento</h2>

  <!-- 🔹 Si el usuario NO tiene planes -->
  <ng-container *ngIf="planesUsuario && planesUsuario.length === 0; else listaPlanes">
    <p class="text-center">No tienes planes de entrenamiento aún.</p>
  </ng-container>

  <!-- 🔹 Si el usuario SÍ tiene planes -->
  <ng-template #listaPlanes>
    <ion-list>
      <ion-item *ngFor="let p of planesUsuario" (click)="agregarAEentrenamiento(p.plan.id)">
        <ion-label>
          {{ p.plan.nombre }} ({{ getDiaSemana(p.plan.dia_semana) }})
        </ion-label>
      </ion-item>
    </ion-list>
  </ng-template>

  <!-- 🟢 Botón para crear nuevo plan -->
  <ion-button
    *ngIf="frecuenciaUsuario > 0 && planesUsuario.length < frecuenciaUsuario"
    expand="block"
    color="primary"
    (click)="creando = !creando"
  >
    {{ creando ? 'Cancelar' : 'Crear nuevo plan' }}
  </ion-button>

  <!-- 🔴 Mensaje si ya llegó al límite -->
  <p *ngIf="frecuenciaUsuario > 0 && planesUsuario.length >= frecuenciaUsuario" class="limite-msg text-center">
    Ya tienes todos tus entrenamientos semanales asignados.
  </p>

  <!-- 🔹 Formulario para crear nuevo plan -->
  <div *ngIf="creando" class="crear-plan mt-3">
    <ion-item>
      <ion-input
        placeholder="Nombre del plan"
        [(ngModel)]="nuevoPlan.nombre"
      ></ion-input>
    </ion-item>

    <ion-item>
      <ion-label position="stacked">Día de la semana</ion-label>
      <ion-select [(ngModel)]="nuevoPlan.dia_semana">
        <ion-select-option [value]="1">Lunes</ion-select-option>
        <ion-select-option [value]="2">Martes</ion-select-option>
        <ion-select-option [value]="3">Miércoles</ion-select-option>
        <ion-select-option [value]="4">Jueves</ion-select-option>
        <ion-select-option [value]="5">Viernes</ion-select-option>
        <ion-select-option [value]="6">Sábado</ion-select-option>
        <ion-select-option [value]="7">Domingo</ion-select-option>
      </ion-select>
    </ion-item>

    <ion-button expand="block" color="success" (click)="crearPlan()">
      Guardar
    </ion-button>
  </div>
</ion-content>

